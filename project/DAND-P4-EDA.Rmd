---
title: "EDA of Red Wine Quality Data"
author: "Mahlon Barrault"
date: "December 14, 2016"
output: html_document
---
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)
library(gridExtra)
library(GGally)
library(reshape2)

try(
  setwd("C:/Users/Mahlon/Source/Repos/DAND-P4-Explore-and-Summarize-Data/project/")
)
try(
  setwd("C:/Source/Repos/DAND-P4-Explore-and-Summarize-Data/project/")
)

load("./.RData")

```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wine_quality <- read.csv("../Data/wineQualityReds.csv")
```

# Univariate Plots Section
```{r echo=TRUE, Univariate_Plots1}
summary(wine_quality)
```
I think it might be useful to have quality as a factor

```{r echo=TRUE, Univariate_Plots2}
wine_quality$quality <- factor(ordered(wine_quality$quality))
str(wine_quality$quality)
summary(wine_quality$quality)
```

Now that I am happy with how quality is looking lets see what it looks like

```{r echo=FALSE, Univariate_Plots3}
ggplot(data = wine_quality, aes(x = quality)) + geom_bar(stat = "count") 
```
No scores of less than 3. Scores of 3 and 4 are uncommon. 5 or better represents the bulk of the wines.
After seeing the distribution of quality I wanted to check the mean and standard deviation. It was a little tricky after converting quality to a factor.

```{r echo=TRUE, Univariate_Plots4}
qual_mean <- mean(as.numeric(levels(wine_quality$quality)[wine_quality$quality]))
qual_sd <- sd(as.numeric(levels(wine_quality$quality)[wine_quality$quality]))
qual_mean
qual_sd
```
The mean and standard deviation look approriate for this distribution

Now let's look at some of the other variables that could contribute to the quality rating

Let's see what the variables related to acidity look like

```{r echo=FALSE, Univariate_Plots}
ggplot(data = wine_quality, aes(x = fixed.acidity)) + geom_histogram(binwidth = 0.2) 
```

```{r echo=FALSE, Univariate_Plots5}
ggplot(data = wine_quality, aes(x = volatile.acidity)) + geom_histogram(binwidth = 0.03) 
```

```{r echo=FALSE, Univariate_Plots7}
ggplot(data = wine_quality, aes(x = citric.acid)) + geom_histogram(binwidth = 0.01)

```

Several wines have 0.00 g/L citric acid. There is an interesting spike of wines with 0.49 g/L citric acid. I will have a closer look at that later.

```{r echo=TRUE, Univariate_Plots8}
#wine_quality$citric.acid
cond <- wine_quality$citric.acid == 0.49
wine_quality[cond,]
```

```{r echo=FALSE, Univariate_Plots9}
ggplot(data = wine_quality, aes(x = pH)) + geom_histogram(binwidth = 0.02) 
```

Most wines in this data set fall between 3.1 and 3.5

Now let's see what the variables for sulphate and related compound content looks like

```{r echo=FALSE, Univariate_Plots10}
ggplot(data = wine_quality, aes(x = free.sulfur.dioxide)) + geom_histogram(binwidth = 1) 
```

```{r echo=FALSE, Univariate_Plots11}
ggplot(data = wine_quality, aes(x = total.sulfur.dioxide)) + geom_histogram(binwidth = 3) 
```

```{r echo=FALSE, Univariate_Plots12}
ggplot(data = wine_quality, aes(x = sulphates)) + geom_histogram(binwidth = 0.02) 
```

All of the sulphate variables seem to have a simular right skew. There seem to be some wines with very high sulphate content relative to the rest of the wines.

Finally let's see what alcohol and related parameters looks like:

```{r echo=FALSE, Univariate_Plots13}
ggplot(data = wine_quality, aes(x = alcohol)) + geom_histogram(binwidth = 0.1)
```
```{r echo=FALSE, Univariate_Plots14}
ggplot(data = wine_quality, aes(x = density)) + geom_histogram(binwidth = 0.0002)
```

```{r echo=FALSE, Univariate_Plots15}
ggplot(aes(x = residual.sugar), data = wine_quality) + 
  geom_histogram(binwidth = 0.1)
```

Let's zoom in on the mean:

```{r echo=FALSE}
ggplot(aes(x = residual.sugar), data = wine_quality) + 
  geom_histogram(binwidth = 0.1) + 
  scale_x_continuous(limits = c(0, 6))
```
Seems like most of the vaules are between 1.5 and 2.5.
There seems to be areas of inscreased frequency at 4 and 5 out on the tail.

```{r echo=FALSE}
ggplot(aes(x = residual.sugar), data = wine_quality) + 
  geom_histogram(binwidth = 0.1) + 
  scale_x_continuous(limits = c(3, 6))
```
There seemed to be some secodary modes in the original plot, however I think all I was noticing places where there sparse values making it seem like an additional peak. 

Looks like most of the red wine sampled fell in the 9% to 11% ABV range. The plot of the density variable looks almost too perfectly normally distributed. It does make sense since there aren't many wines with a very high alcohol content or very high residual sugars. I was expecting the alcohol and residual sugar plots to appear very similar. The relationship between these two variables must be more complex than I expected.

# Univariate Analysis

### What is the structure of your dataset?
```{r}
str(wine_quality)
```
There are 1599 red wines in this dataset each with measurements of 11 of their physiochemical properties and a sensory measurement of quality. The quality variable is the median of at least 3 taste tests by wine experts. I have chosen to make quality and ordered factor to reflect the specification the researchers used when collecting these data - the higer the number, the better the wine.

### What is/are the main feature(s) of interest in your dataset?
The dataset has several related groups of variables. With a view to predicting a quality rating one might consider the primary flavor or aromatic factors such as acidity (fixed.acidity, volatile.acidity, citric.acid) or sweetness (residual.sugars). The dataset provides other measurements of interest. I am particularly interested in discovering if the group of varibles for amounts of sulphur containting compounds (free.sulfur.dioxide, total.sulful.dioxide, sulphates) has any effect on the quality score.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
I suspect that there might be multicolinearity in this data since often times the presence of higher acidity or sugars can alter ones perception of other compounds. I plan to investigate the how acidity and higher sugar content work in conjunction with the sulfur containing compound to effect the quality rating.

### Did you create any new variables from existing variables in the dataset?
Most of the variables in this dataset seemed to be valuable on their own and there wasn't any clear way to combine any of them in a meaningful way. One alteration I did make was to convert the quality variable in to a factor for easier analysis.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
Some of the distributions were unexpected but not bizarre in any way.


# Bivariate Plots Section

The first thing I like to do is have a look at all the pairs so I know where to spend additional time:

```{r echo=FALSE, Bivariate_Plots0}
# http://stackoverflow.com/questions/34975190/set-alpha-and-remove-black-outline-of-density-plots-in-ggpairs
ggscatalpha <- function(data, mapping, ...) {
  ggplot(data = data, mapping = mapping) +
    geom_point(..., alpha = 0.25)
}

ggdensalpha <- function(data, mapping, ...) {
  ggplot(data = data, mapping = mapping) +
    geom_density(..., alpha = 0.25)
}
```

```{r echo=FALSE, Bivariate_Plots1}
wq.names.acid <- c("fixed.acidity", "volatile.acidity", "citric.acid", "pH")
ggpairs(wine_quality,
        columns = wq.names.acid, 
        mapping = aes(color = quality), 
        lower = list(continuous = ggscatalpha), 
        diag = list(continuous = ggdensalpha))
```
The negative correlation between citric.acid and volatile.acid is interesting here. I will be sure to investigate that further. Also, it seems like the highest rated wines have lower volitile.acidity and higher citric.acid. On the other hand, the lowest rated wines tend to have higher volatile.acidity.

```{r echo=FALSE, Bivariate_Plots2}
wq.names.sulphur <- c("free.sulfur.dioxide", "total.sulfur.dioxide", "sulphates", "chlorides")
ggpairs(wine_quality,
        columns = wq.names.sulphur,
        mapping = aes(color = quality),
        lower = list(continuous = ggscatalpha), 
        diag = list(continuous = ggdensalpha))
```
 Surprisingly, it would seem like high sulphates has a positive effect on the wine's rating.
 
```{r echo=FALSE, Bivariate_Plots3}
wq.names.alcohol <- c("alcohol", "residual.sugar", "density")
ggpairs(wine_quality,
        columns = wq.names.alcohol,
        mapping = aes(color = quality),
        lower = list(continuous = ggscatalpha), 
        diag = list(continuous = ggdensalpha))
```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
